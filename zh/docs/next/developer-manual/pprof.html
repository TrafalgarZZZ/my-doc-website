<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developer-manual/pprof" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">使用 pprof 对 Fluid 组件进行性能分析 | Fluid</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://trafalgarzzz.github.io/my-doc-website/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://trafalgarzzz.github.io/my-doc-website/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://trafalgarzzz.github.io/my-doc-website/zh/docs/next/developer-manual/pprof"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="使用 pprof 对 Fluid 组件进行性能分析 | Fluid"><meta data-rh="true" name="description" content="背景介绍"><meta data-rh="true" property="og:description" content="背景介绍"><link data-rh="true" rel="icon" href="/my-doc-website/zh/img/fluid-icon-color.png"><link data-rh="true" rel="canonical" href="https://trafalgarzzz.github.io/my-doc-website/zh/docs/next/developer-manual/pprof"><link data-rh="true" rel="alternate" href="https://trafalgarzzz.github.io/my-doc-website/docs/next/developer-manual/pprof" hreflang="en"><link data-rh="true" rel="alternate" href="https://trafalgarzzz.github.io/my-doc-website/zh/docs/next/developer-manual/pprof" hreflang="zh"><link data-rh="true" rel="alternate" href="https://trafalgarzzz.github.io/my-doc-website/docs/next/developer-manual/pprof" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/my-doc-website/zh/blog/rss.xml" title="Fluid RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/my-doc-website/zh/blog/atom.xml" title="Fluid Atom Feed"><link rel="stylesheet" href="/my-doc-website/zh/assets/css/styles.a72fcd24.css">
<script src="/my-doc-website/zh/assets/js/runtime~main.5e0925a2.js" defer="defer"></script>
<script src="/my-doc-website/zh/assets/js/main.69399b0b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-doc-website/zh/"><div class="navbar__logo"><img src="/my-doc-website/zh/img/fluid-horizontal-color.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-doc-website/zh/img/fluid-horizontal-white.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-doc-website/zh/docs/next">文档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/my-doc-website/zh/docs/next">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/my-doc-website/zh/docs/next/developer-manual/pprof">Next</a></li><li><a class="dropdown__link" href="/my-doc-website/zh/docs/developer-manual/pprof">0.9</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/my-doc-website/docs/next/developer-manual/pprof" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/my-doc-website/zh/docs/next/developer-manual/pprof" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/fluid-cloudnative/fluid" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/my-doc-website/zh/docs/next">快速开始</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/my-doc-website/zh/docs/next/core-concepts/introduction">核心概念</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/my-doc-website/zh/docs/next/user-manual/data-accelerate/accelerate_data_accessing">用户手册</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/my-doc-website/zh/docs/next/developer-manual/how_to_develop">开发者手册</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/my-doc-website/zh/docs/next/developer-manual/how_to_develop">Fluid开发文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/my-doc-website/zh/docs/next/developer-manual/dev_with_kind">Setting up Fluid Development Environment with Kind on MacOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-doc-website/zh/docs/next/developer-manual/pprof">使用 pprof 对 Fluid 组件进行性能分析</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>此为 <!-- -->Fluid<!-- --> <b>Next</b> 版尚未发行的文档。</div><div class="margin-top--md">最新的文档请参阅 <b><a href="/my-doc-website/zh/docs/developer-manual/pprof">最新版本</a></b> (<!-- -->0.9<!-- -->)。</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/my-doc-website/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">开发者手册</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">使用 pprof 对 Fluid 组件进行性能分析</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>使用 pprof 对 Fluid 组件进行性能分析</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景介绍">背景介绍<a href="#背景介绍" class="hash-link" aria-label="背景介绍的直接链接" title="背景介绍的直接链接">​</a></h2>
<p>pprof 是一个用于可视化和分析性能数据的工具，它可以收集程序的 CPU、内存、堆栈等信息，并对其生成文本和图形报告。</p>
<p>Fluid 社区已经在各个组件内开启了 pprof 服务，用户可以在进入组件 Pod 内部后访问 <em><a href="http://127.0.0.1:6060/debug/pprof/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:6060/debug/pprof/</a></em> 即可看到相关信息。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前提条件">前提条件<a href="#前提条件" class="hash-link" aria-label="前提条件的直接链接" title="前提条件的直接链接">​</a></h2>
<p>在运行该示例之前 ，请参考<a href="/my-doc-website/zh/docs/next/userguide/install.md">安装文档</a>完成安装，并检查Fluid各组件正常运行：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod -n fluid-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alluxioruntime-controller-5b64fdbbb-84pc6   1/1     Running   0          8h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">csi-nodeplugin-fluid-fwgjh                  2/2     Running   0          8h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">csi-nodeplugin-fluid-ll8bq                  2/2     Running   0          8h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset-controller-5b7848dbbb-n44dj         1/1     Running   0          8h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通常来说，你会看到一个名为<code>dataset-controller</code>的Pod、一个名为<code>alluxioruntime-controller</code>的Pod和多个名为<code>csi-nodeplugin</code>的Pod正在运行。其中，<code>csi-nodeplugin</code>这些Pod的数量取决于你的Kubernetes集群中结点的数量。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="进入需要进行性能分析的组件-pod-内部">进入需要进行性能分析的组件 Pod 内部<a href="#进入需要进行性能分析的组件-pod-内部" class="hash-link" aria-label="进入需要进行性能分析的组件 Pod 内部的直接链接" title="进入需要进行性能分析的组件 Pod 内部的直接链接">​</a></h2>
<p>查看 Fluid 各个组件 Pod 的名称（本文以 Fluid 的 dataset-controller 为例进行性能分析）。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n fluid-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                  READY   STATUS    RESTARTS         AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">csi-nodeplugin-fluid-kg9bc            2/2     Running   0                22h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">csi-nodeplugin-fluid-nbbjk            2/2     Running   0                22h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">csi-nodeplugin-fluid-vjdfz            2/2     Running   0                22h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset-controller-77cfc8f9bf-m488j   1/1     Running   0                22h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fluid-webhook-5f76bb6567-jwpbk        1/1     Running   0                22h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fluidapp-controller-b7c4d5579-ztvlw   1/1     Running   0                22h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入 dataset-controller Pod 内部。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it dataset-controller-77cfc8f9bf-m488j -n fluid-system bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="进行性能分析">进行性能分析<a href="#进行性能分析" class="hash-link" aria-label="进行性能分析的直接链接" title="进行性能分析的直接链接">​</a></h2>
<p>在安装完 Go 环境后，可以使用 <strong>go tool pprof</strong> 命令进行性能分析。此外用户也可以访问 <em><a href="http://127.0.0.1:6060/debug/pprof/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:6060/debug/pprof/</a></em> 查看部分数据信息。</p>
<p>pprof 可以分析程序的以下数据：</p>
<ul>
<li>
<p>allocs：查看过去所有内存分配的样本</p>
</li>
<li>
<p>block：查看导致阻塞同步的堆栈跟踪</p>
</li>
<li>
<p>cmdline： 当前程序的命令行的完整调用路径</p>
</li>
<li>
<p>goroutine：查看当前所有运行的 goroutines 堆栈跟踪</p>
</li>
<li>
<p>heap：查看活动对象的内存分配情况</p>
</li>
<li>
<p>mutex：查看导致互斥锁的竞争持有者的堆栈跟踪</p>
</li>
<li>
<p>profile：CPU 概要文文件</p>
</li>
<li>
<p>threadcreate：查看创建新 OS 线程的堆栈跟踪</p>
</li>
<li>
<p>trace：当前程序执行的跟踪</p>
</li>
<li>
<p>allocs：A sampling of all past memory allocations</p>
</li>
<li>
<p>block：Stack traces that led to blocking on synchronization primitives</p>
</li>
<li>
<p>cmdline： The command line invocation of the current program。</p>
</li>
<li>
<p>goroutine：Stack traces of all current goroutines</p>
</li>
<li>
<p>heap：A sampling of memory allocations of live objects. You can specify the gc GET parameter to run GC before taking the heap sample.</p>
</li>
<li>
<p>mutex：Stack traces of holders of contended mutexes</p>
</li>
<li>
<p>profile： CPU profile. You can specify the duration in the seconds GET parameter. After you get the profile file, use the go tool pprof command to investigate the profile.</p>
</li>
<li>
<p>threadcreate：Stack traces that led to the creation of new OS threads</p>
</li>
<li>
<p>trace：A trace of execution of the current program. You can specify the duration in the seconds GET parameter. After you get the trace file, use the go tool trace command to investigate the trace.</p>
</li>
</ul>
<p>收集您关注的类型的数据，本文以 30 秒 CPU 数据为例，将数据保存为 profile.out。您可以在 Pod 内或将 profile.out 复制到本地使用 <code>go tool pprof</code> 命令进行分析（需要 Go 环境）。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -o profile.out http://localhost:6060/debug/pprof/profile?seconds=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ go tool pprof test.out </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">File: dataset-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time: Nov 2, 2022 at 6:48pm (CST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Duration: 29.91s, Total samples = 50ms ( 0.17%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(pprof) </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在交互终端内输入 <code>top5</code> 命令打印消耗 CPU 资源前5的函数。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(pprof) top5   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Showing nodes accounting for 50ms, 100% of 50ms total</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Showing top 5 nodes out of 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      flat  flat%   sum%        cum   cum%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      10ms 20.00% 20.00%       10ms 20.00%  github.com/fluid-cloudnative/fluid/vendor/golang.org/x/net/http2.(*Transport).expectContinueTimeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      10ms 20.00% 40.00%       10ms 20.00%  net/http.cloneURL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      10ms 20.00% 60.00%       10ms 20.00%  path.(*lazybuf).append</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      10ms 20.00% 80.00%       10ms 20.00%  runtime.memclrNoHeapPointers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      10ms 20.00%   100%       10ms 20.00%  runtime.newarray</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>更多使用信息，请查看<a href="https://github.com/google/pprof" target="_blank" rel="noopener noreferrer">文档</a></strong></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/TrafalgarZZZ/my-doc-website/tree/master/docs/developer-manual/pprof.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>trafalgarzzz</b> <!-- -->于 <b><time datetime="2024-02-15T13:02:19.000Z">2024年2月15日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/my-doc-website/zh/docs/next/developer-manual/dev_with_kind"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Setting up Fluid Development Environment with Kind on MacOS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#背景介绍" class="table-of-contents__link toc-highlight">背景介绍</a></li><li><a href="#前提条件" class="table-of-contents__link toc-highlight">前提条件</a></li><li><a href="#进入需要进行性能分析的组件-pod-内部" class="table-of-contents__link toc-highlight">进入需要进行性能分析的组件 Pod 内部</a></li><li><a href="#进行性能分析" class="table-of-contents__link toc-highlight">进行性能分析</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-doc-website/zh/docs">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TrafalgarZZZ/my-doc-website" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 The Fluid Authors. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: https://www.linuxfoundation.org/trademark-usage</div></div></div></footer></div>
</body>
</html>